---
title: x230T, realtek wifi, and my solution
author: Adam Stokes
layout: post
permalink: /x230t-realtek-wifi-and-my-solution/
categories:
  - Ubuntu
  - "What's New"
tags:
  - linux
  - sosreport
  - Ubuntu
---
<h2 id="recap">Recap</h2> 

I can ping all devices on the network *except* the gateway  
(192.168.0.1) and in turn can not access outside of the network  
without proxying through another device.

The system:

Lenovo x230 Tablet with a Realtek wifi adapter running on Quantal:

Network controller: Realtek Semiconductor Co., Ltd. RTL8188CE  
802.11b/g/n WiFi Adapter (rev 01)

The wtf:

I can obtain an IP from the router<pre class="prettyprint"> wlan0 Link encap:Ethernet HWaddr e0:06:e6:c2:d2:e0 inet addr:192.168.0.102 Bcast:192.168.0.255 Mask:255.255.255.0 inet6 addr: fe80::e206:e6ff:fec2:d2e0/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:178844 errors:0 dropped:0 overruns:0 frame:0 TX packets:101517 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:121465876 (121.4 MB) TX bytes:10612848 (10.6 MB) </pre> 

I can ping other devices:<pre class="prettyprint"> &#10140; ~ ping 192.168.0.101 PING 192.168.0.101 (192.168.0.101) 56(84) bytes of data. 64 bytes from 192.168.0.101: icmp\_req=1 ttl=64 time=3.84 ms 64 bytes from 192.168.0.101: icmp\_req=2 ttl=64 time=1.32 ms </pre> 

I can not ping the gateway:<pre class="prettyprint"> &#10140; ~ ping 192.168.0.1 PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data. From 192.168.0.102 icmp\_seq=1 Destination Host Unreachable From 192.168.0.102 icmp\_seq=2 Destination Host Unreachable </pre> 

My resolv.conf is autogenerated with:<pre class="prettyprint"> &#10140; ~ cat /etc/resolv.conf # Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8) # DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN nameserver 127.0.1.1 search nc.rr.com </pre> 

My /etc/hosts:<pre class="prettyprint"> &#10140; ~ cat /etc/hosts 127.0.0.1 localhost 127.0.1.1 quantal </pre> 

My routing table:<pre class="prettyprint"> &#10140; ~ route Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface default 192.168.0.1 0.0.0.0 UG 0 0 0 wlan0 link-local \* 255.255.0.0 U 1000 0 0 wlan0 192.168.0.0 \* 255.255.255.0 U 9 0 0 wlan0 </pre> 

Lastly, my module info for device:<pre class="prettyprint"> &#10140; ~ modinfo rtl8192ce filename: /lib/modules/3.5.0-17-generic/kernel/drivers/net/wireless/rtlwifi/rtl8192ce/rtl8192ce.ko firmware: rtlwifi/rtl8192cfw.bin description: Realtek 8192C/8188C 802.11n PCI wireless license: GPL author: Larry Finger <Larry.Finger@lwfinger.net> author: Realtek WlanFAE <wlanfae@realtek.com> author: lizhaoming <chaoming\_li@realsil.com.cn> srcversion: DD4F3D83A75531AC98862F2 alias: pci:v000010ECd00008176sv\*sd\*bc\*sc\*i\* alias: pci:v000010ECd00008177sv\*sd\*bc\*sc\*i\* alias: pci:v000010ECd00008178sv\*sd\*bc\*sc\*i\* alias: pci:v000010ECd00008191sv\*sd\*bc\*sc\*i\* depends: rtlwifi,mac80211 vermagic: 3.5.0-17-generic SMP mod\_unload modversions parm: swlps:bool parm: swenc:using hardware crypto (default 0 [hardware]) (bool) parm: ips:using no link power save (default 1 is open) (bool) parm: fwlps:using linked fw control power save (default 1 is open) (bool) </pre> 

Things I've attempted:

Turning off fwlps, ips. Attempted to compile a driver from upstream  
and even tried the latest daily mainline kernel for Quantal.

Has anyone seen this before? What really baffles me is that I can not  
ping the gateway. To verify I can ping the gateway from another  
system:<pre class="prettyprint"> ~ : ping 192.168.0.1 PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data. 64 bytes from 192.168.0.1: icmp\_req=1 ttl=64 time=1.35 ms 64 bytes from 192.168.0.1: icmp\_req=2 ttl=64 time=1.22 ms 64 bytes from 192.168.0.1: icmp_req=3 ttl=64 time=5.11 ms </pre> 

This also doesn't happen outside of my network as I was able to use  
this laptop at UDS-R which kind of points to a router issue but  
anything without a Realtek adapter works :\<h2 id="solution">Solution</h2> 

Turns out that this particular laptop was having issues resolving dns queries because on my particular cable modem/router there was an option for "Enable DNS relay" that was not checked (off). Once I checked that option my laptop suddenly started working! I tried to do some more research on what could be a possible reason as to why this specific laptop/wifi combo requires dns relay to be enabled on the router in order to access anything outside my network? Another odd thing is that if I directly connect the laptop to the router everything works so I assume it is something to do with the actual wifi driver/hardware. Anyway, I'm finally back to being able to use my recently purchased laptop <img src="http://i1.wp.com/astokes.org/wp-includes/images/smilies/icon_smile.gif?w=720" alt=":)" class="wp-smiley" data-recalc-dims="1" />

p.s &#8211; Im in London next week so if any kernel guys are feeling gracious and would like to look at my laptop I'll have it with me.